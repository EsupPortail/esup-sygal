# Version 5.0.2

## 1. Sur le serveur d'application

- Placez-vous dans le répertoire de l'application puis lancez la commande suivante
  pour installer la nouvelle version :

```bash
git fetch --tags && git checkout --force 5.0.2 && bash ./install.sh
```

- Selon le moteur PHP que vous avez installé, rechargez le service, exemple :
    - php7.4-fpm         : `service php7.4-fpm reload`
    - apache2-mod-php7.4 : `service apache2 reload`


- Certains fichiers téléversés jusqu'à maintenant dans l'application ont été stockés dans le mauvais répertoire
  ("rapport_activite"), ce n'est pas rédhibitoire mais nous allons quand même corriger cela, en concordance avec 
  cette version 5.0.2 :

    - Placez-vous dans le répertoire destination des fichiers téléversés : son chemin est configuré via la clé de config 
      `fichier` > `dir_root_path` d'un fichier de config, ex : "config/autoload/prod.secret.local.php"), ex :
      ```bash
      cd /app/upload
      ```
    - Créez les répertoires `rapport_csi` et `rapport_miparcours` :
      ```bash
      mkdir -p rapport_csi
      mkdir -p rapport_miparcours
      ```
    - Lancez la commande suivante pour déplacer les fichiers au bon endroit :
      ```bash
      sudo mv -v rapport_activite/RAPPORT-CSI-*        rapport_csi
      sudo mv -v rapport_activite/RAPPORT-MIPARCOURS-* rapport_miparcours
      ```
    - Ajustez les droits d'accès aux répertoires `rapport_csi` et `rapport_miparcours` :
      ```bash
      sudo chown -R www-data:root rapport_csi        && sudo chmod -R 770 rapport_csi
      sudo chown -R www-data:root rapport_miparcours && sudo chmod -R 770 rapport_miparcours
      ```

## 2. Dans la base de données

RAS.
