<?php

use Admission\Entity\Db\Admission;
use Application\View\Renderer\PhpRenderer;

/**
 * @var PhpRenderer $this
 * @var Admission[] $admissions
 * @see \Admission\Controller\AdmissionController::inscriptionAction()
 */
?>

<?php $this->headTitle($this->translate($title = "Admission")) ?>

<h1 class="page-header"><?php echo $this->translate($title); ?> </h1>

<p class="introduction">Cette application permet dans un premier temps de candidater à un parcours doctoral.
    <br>Vous devrez remplir un formulaire en ligne et déposer les documents demandés.<br>
</p>
<?= $this->messenger()->addCurrentMessagesFromFlashMessengerWithNoNamespace() ?>

<div class="form_admission">
    <form action="<?php echo $this->url('admission', [], [], true); ?>" method="post">
        <div class="row">
            <div class="col-lg-4 col-sm-12">
                <label for="individuId">Entrez l'ID de l'individu :</label>
            </div>
            <div class="col-lg-3 col-sm-12">
                <input class="form-control" type="text" id="individuId" name="individuId">
            </div>
            <div class="col-lg-5 col-sm-12">
                <button type="submit" class="btn btn-primary">Accéder à son dossier d'admission</button>
            </div>
        </div>
    </form>
</div>
<h2>Dossiers d'admissions en cours</h2>
<p><?php echo count($admissions)." dossier(s) d'admission(s) trouvé(s)";?></p>
<table class="table table-sm">
    <thead>
    <tr>
        <th>Nom de l'étudiant</th>
        <th>Statut</th>
        <th>Titre provisoire de la thèse</th>
        <th>Action</th>
    </tr>
    </thead>
    <tbody>
    <?php foreach ($admissions as $admission): ?>
        <tr>
            <td><?php echo $admission->getIndividu()->getNomUsuel()." ".$admission->getIndividu()->getPrenom(); ?></td>
            <td><?php echo $admission->getEtat()->getLibelle() ?></td>
            <td><?php echo $admission->getInscription()->first() ? $admission->getInscription()->first()->getTitreThese() : ""; ?></td>
            <td>
                <a href="<?php echo $this->url('admission/ajouter', ['action' => 'etudiant','individu' => $admission->getIndividu()->getId()], [], true) ?>">Accéder</a>
            </td>
        </tr>
    <?php endforeach; ?>
    </tbody>
</table>
